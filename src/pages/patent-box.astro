---
import BaseLayout from '../layouts/BaseLayout.astro';
import PatentBoxCalculator from "../components/calculators/PatentBoxCalculator.astro";
import FAQ from '../components/widgets/FAQ.astro';
import ProcessSteps from '../components/widgets/ProcessSteps.astro';
import { getEntry } from 'astro:content';

const pageContent = await getEntry('pages', 'patent-box');
const { Content } = await pageContent.render();
const { title, description, hero, benefits, warning } = pageContent.data;

const processSteps = [
  {
    letter: '1',
    title: 'Overenie, či ide o chránené riešenie',
    description: 'Kontrola, či duševné vlastníctvo spĺňa podmienky pre Patent Box.',
  },
  {
    letter: '2',
    title: 'Identifikácia výnosov z predaja',
    description: 'Určenie príjmov z využívania duševného vlastníctva.',
  },
  {
    letter: '3',
    title: 'Nastavenie evidencie',
    description: 'Vytvorenie systému na sledovanie príjmov z IP.',
  },
  {
    letter: '4',
    title: 'Výpočet úspory',
    description: 'Vypočítanie výšky daňového zvýhodnenia.',
  },
  {
    letter: '5',
    title: 'Úprava výdavkov o zodpovedajúcu časť',
    description: 'Správne zaúčtovanie odpočtu.',
  },
  {
    letter: '6',
    title: 'Uplatnenie v daňovom priznaní',
    description: 'Zahrnutie Patent Box do daňového priznania.',
  },
];

const contact = {
  name: "Ing. Mgr. Martin Gondár",
  role: "managing partner SmarTech Solutions SK",
  phone: "+421 904 352 451",
  email: "gondar@smartech.sk",
};
---

<BaseLayout title={title} description={description}>
  <!-- HERO -->
  <section class="page-hero">
    <div class="container">
      <p class="page-hero-label">PATENT BOX</p>
      <h1 class="page-hero-title">
        {hero.heading}
      </h1>
    </div>
  </section>
  
  <!-- ÚVODNÝ TEXT + KALKULAČKA POD NÍM -->
  <section class="page-section page-section--light">
    <div class="container">
      <div class="home-section-divider"></div>
      <div class="vav-intro-text">
        <div class="vav-intro-copy">
          {hero.text}
        </div>
      </div>

      <div class="vav-intro-text">
        <div class="vav-intro-copy">
          <Content />
        </div>
      </div>

        {benefits && (
          <>
            <h2 class="page-section-title">Prínosy</h2>
            <ul class="space-y-4 mb-8">
              {benefits.map((benefit) => (
                <li class="flex gap-3">
                  <svg class="w-6 h-6 text-green-600 flex-shrink-0 mt-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  <span set:html={benefit} />
                </li>
              ))}
            </ul>
          </>
        )}

        {warning && (
          <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-30">
            <p class="text-green-800">
              <strong>Bonus:</strong> {warning}
            </p>
          </div>
        )}

      <div class="vav-calc-card">
        <h2 class="vav-calc-heading">Kalkulačka úspory</h2>
        <PatentBoxCalculator />                     
      </div>
    </div>
  </section>

  <!-- PROCES UPLATNENIA -->
  <section class="page-section vav-process-section">
    <div class="container">
      <div class="home-section-divider"></div>
      <h2 class="page-section-title">Proces uplatnenia v bodoch</h2>
      <ProcessSteps steps={processSteps} />
    </div>
  </section>

  <!-- FAQ BLOK -->
  <section class="page-section page-section--light vav-faq-section">
    <div class="container">
      <div class="home-section-divider"></div>
      <h2 class="page-section-title">
        Najčastejšie otázky k patent boxu
      </h2>
      <FAQ category="patent-box" />
    </div>
  </section>

  <!-- KONTAKT (rovnaký štýl ako na homepage) -->
  <section class="home-section" id="kontakt">
    <div class="container">
      <div class="home-section-divider"></div>

      <h2>Získajte odpoveď ihneď od odborníka s praxou.</h2>
      <p class="home-section-text">
        Každá firma je iná a preto sa radi pozrieme na konkrétne možnosti
        uplatnenia superodpočtu u Vás.
      </p>

      <div class="home-contact-card">
        <div>
          <p class="home-contact-name">{contact.name}</p>
          <p class="home-contact-role">{contact.role}</p>
          <p class="home-contact-contact">
            {contact.phone}
            <br />
            {contact.email}
          </p>

          <a
            href="https://www.smartech.sk/kontakt/predaudit-konzultacia"
            class="home-contact-button"
            target="_blank"
            rel="noopener"
          >
            Kontaktujte SmarTech Solutions
          </a>
        </div>

        <div class="home-contact-photo">
          <img
            src="/images/MGO.webp"
            alt="Ing. Mgr. Martin Gondár"
            loading="lazy"
            decoding="async"
          />
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
